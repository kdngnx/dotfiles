#!/usr/bin/env bash
# vim: ft=bash

dir=$(find ~/personal ~/repos -maxdepth 3 -type d | sed '1s|^|'"$HOME"\\n'|' | fzf --tmux)
[ -z "$dir" ] && exit 0

# let choosing $HOME goes to first session
if [ "$dir" = "$HOME" ]; then
  tmux switch-client -t 0
  exit 0
fi

# otherwise, create a new session with corresponding project name
name=$(basename "$dir")
if ! tmux has-session -t "$name" 2>/dev/null; then
  tmux new-session -s "$name" -d -c "$dir"
fi
tmux switch-client -t $name
